function [F1_,F0_,F3,F,F2,A1,B1,muy,hamy_]=tinhF1_(T_dau,eps)
K = 0.034;
T0 = 45;
muy = max(exp(-K*(T_dau-T0)),0);
% muy = ones(size(T_dau));
k1 = size(T_dau,2)-1;
y1 = 1/k1;
hamy_ = zeros(size(T_dau));
for i = 0:k1
    hamy_(:,i+1,:)=y1*i;
end
hamF1_ = hamy_./muy;
F1_ = sum(hamF1_,2)*y1;
hamF0_ = 1./muy;
F0_ = sum(hamF0_,2)*y1;
F3 = F1_./F0_;
F = 1-F3;
hamF2 = hamy_./muy.*(hamy_-F3);
F2 = sum(hamF2,2)*y1;
F = reshape(F,size(F,1),size(F,3));
F2 = reshape(F2,size(F2,1),size(F2,3));
x = linspace(0,2*pi,size(F,1)-2);
h_=1+eps*cos(x);
h_=[h_(1) h_ h_(end)];
h_=h_';
h_=repmat(h_,[1 k1+1 size(F,3)]);
hamK1 = hamy_.*h_.^2./muy;
K1 = cumsum(hamK1,2)*y1;
hamK2 = h_.^2./muy;
K2 = cumsum(hamK2,2)*y1;
F3_mul = repmat(F3,[1 k1+1 1]);
A1 = K1 - F3_mul.*K2;
K3 = cumsum(hamF0_,2)*y1;
F0_mul = repmat(F0_,[1 k1+1 1]);
B1 = K3./F0_mul;
B2 = zeros(size(B1));
end